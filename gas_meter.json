[
    {
        "id": "559a98ba.60a488",
        "type": "tab",
        "label": "Flow 1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "5789bac0.70b3c4",
        "type": "rpi-gpio in",
        "z": "559a98ba.60a488",
        "name": "Reedkontakt",
        "pin": "7",
        "intype": "tri",
        "debounce": "100",
        "read": false,
        "x": 150,
        "y": 540,
        "wires": [
            [
                "94892c1d.8b06e"
            ]
        ]
    },
    {
        "id": "cd8f139f.6ad1f",
        "type": "file",
        "z": "559a98ba.60a488",
        "name": "",
        "filename": "zaehler.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 530,
        "y": 460,
        "wires": [
            [
                "cf31072c.9ef708",
                "f74dd19f.a1f66"
            ]
        ]
    },
    {
        "id": "94892c1d.8b06e",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "Gaszaehler",
        "func": "// Gaszaehler  2020-04-01\n\nvar now = new Date() ;\n\n   global.set ('gX_zeit', 0 ) ; // Heart-beat\n\n   Reed = msg.payload ;\n   global.set ('gReed', Reed )  ;\n\n   Dividend = 10400000 ; // 104 Sekunden = 100 %\n   \n\n   if (Reed == 1) {  \n     global.set ('gGaszaehler', (global.get('gGaszaehler') + 1)) ;\n     global.set ('gPulslaenge', \n                   Date.now() - global.get('gUp_flanke') ) ;\n     if (global.get ('gMin') > global.get ('gPulslaenge'))\n       { global.set ('gMin',   global.get ('gPulslaenge')) }\n     global.set ('gLeistung', \n       Math.trunc ( (global.get ('gMin') / \n                     global.get ('gPulslaenge') ) * 100) ) ;\n   }\n  \n  \n  function ISODateString(d){\n    function pad(n){return n<10 ? '0'+n : n}\n    return d.getFullYear()+'-'\n    + pad(d.getMonth()+1) +'-'\n    + pad(d.getDate())    +' '\n    + pad(d.getHours())   +':'\n    + pad(d.getMinutes()) +':'\n    + pad(d.getSeconds())\n}\n\n// now.toLocaleString() \n\n  msg.payload  =   ISODateString (now)\n//      + \", \" +     (global.get(\"gGaszaehler\") / 10 ) \n      + \", \" +     Number.parseFloat\n   ((global.get('gGaszaehler')/\n     global.get('gImpulse_per_m3'))).toFixed(1) \n      + \", \" +     Reed      \n //   + \", \" +     ((Date.now()-global.get('gUp_flanke'))/1000)      \n //   + \", \" +     ((Date.now()-global.get('gDn_flanke'))/1000)      \n      + \", \" +     Number.parseFloat\n                  ((global.get ('gPulslaenge')/1000)).toFixed(1)  \n      + \", \" +      global.get ('gLeistung') \n                ;\n  \n  \n  if ( global.get('gImpulse_per_m3') == 100 ) {\n  msg.payload  =   ISODateString (now)\n      + \", \" +     Number.parseFloat\n   ((global.get('gGaszaehler')/\n     global.get('gImpulse_per_m3'))).toFixed(2) \n      + \", \" +     Reed      \n      + \", \" +     Number.parseFloat\n                  ((global.get ('gPulslaenge')/1000)).toFixed(1)  \n      + \", \" +      global.get ('gLeistung') \n                ;\n      \n   \n   \n      \n      \n      \n   }\n  \n  \n   if (Reed == 1) { global.set ('gUp_flanke', Date.now() ) ; } \n   else           { global.set ('gDn_flanke', Date.now() ) ; } \n\n   global.set ('gX_flanke', Date.now() ) ; \n   msg.topic = \"\" ;\n   \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 330,
        "y": 460,
        "wires": [
            [
                "cd8f139f.6ad1f",
                "7c8820eb.f7b07",
                "a641b296.29084"
            ]
        ]
    },
    {
        "id": "cf31072c.9ef708",
        "type": "ui_text",
        "z": "559a98ba.60a488",
        "group": "ba8e00a6.e48ab",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "gas",
        "label": "Log",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 710,
        "y": 460,
        "wires": []
    },
    {
        "id": "933d4d91.77594",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reed-An",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "num",
        "topic": "",
        "x": 140,
        "y": 500,
        "wires": [
            [
                "94892c1d.8b06e"
            ]
        ]
    },
    {
        "id": "9a0f758c.6c12a8",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 7,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reed-Aus",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "",
        "x": 140,
        "y": 460,
        "wires": [
            [
                "94892c1d.8b06e"
            ]
        ]
    },
    {
        "id": "7c8820eb.f7b07",
        "type": "switch",
        "z": "559a98ba.60a488",
        "name": "Steigende_Flanke",
        "property": "gReed",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 430,
        "y": 560,
        "wires": [
            [
                "208d618c.f401fe",
                "5d2f5fad.6ea5b"
            ]
        ]
    },
    {
        "id": "208d618c.f401fe",
        "type": "file",
        "z": "559a98ba.60a488",
        "name": "",
        "filename": "zaehler1.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 590,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "5d2f5fad.6ea5b",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "Leistung",
        "func": "msg.payload = global.get('gLeistung') ;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 640,
        "wires": [
            [
                "c05e105b.55dd",
                "7cd4ecc0.a4ed64",
                "9c9285f3.1a2568",
                "9bc45d85.60248",
                "5f07f114.0984d",
                "58005a7d.94bb24",
                "c8a30219.f2fd2"
            ]
        ]
    },
    {
        "id": "9c9285f3.1a2568",
        "type": "ui_gauge",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Leistung",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "100",
        "seg2": "101",
        "x": 660,
        "y": 540,
        "wires": []
    },
    {
        "id": "8757328e.4db92",
        "type": "inject",
        "z": "559a98ba.60a488",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 100,
        "wires": [
            [
                "8482028.12ed1"
            ]
        ]
    },
    {
        "id": "8482028.12ed1",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "init",
        "func": "// Init, 2021-04-01\n\nglobal.set ('gGaszaehler', 40215 ) ; // am 2021-01-31\nglobal.set ('gGas_24',     40215 ) ;\nglobal.set ('gAbstand',    0 ) ;\nglobal.set ('gX_zeit',     0 ) ;\nglobal.set ('gReed',       0 ) ;\nglobal.set ('gMin',    900000 ) ;\nglobal.set ('gLeistung',  60 ) ;\nglobal.set ('gImpulse_per_m3', 10 ) ; \n\n\nglobal.set ('gGenerator',     0     ) ;\n\nglobal.set ('gSchwellenwert', 600000 ) ; \n\nglobal.set ('gX_flanke',  msg.payload ) ; \nglobal.set ('gUp_flanke', msg.payload ) ;\nglobal.set ('gDn_flanke', msg.payload ) ;\n\nglobal.set (\"gPulslaenge\", 150000) ; // 150 Sekunden\n\n// msg.payload = Date.now() ;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 270,
        "y": 100,
        "wires": [
            [
                "6fb394b2.6f1d0c",
                "10b52604.55466a"
            ]
        ]
    },
    {
        "id": "a8928a4f.732c48",
        "type": "switch",
        "z": "559a98ba.60a488",
        "name": "Schwelle_ueberschritten",
        "property": "gX_zeit",
        "propertyType": "global",
        "rules": [
            {
                "t": "gt",
                "v": "gSchwellenwert",
                "vt": "global"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 410,
        "y": 700,
        "wires": [
            [
                "5d2f5fad.6ea5b"
            ]
        ]
    },
    {
        "id": "ecb8e757.343ba8",
        "type": "inject",
        "z": "559a98ba.60a488",
        "name": "23:59",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "59 23 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 360,
        "wires": [
            [
                "66b278bb.5f9f48",
                "214b0dcd.942eb2"
            ]
        ]
    },
    {
        "id": "8dc5944f.68b5a8",
        "type": "file",
        "z": "559a98ba.60a488",
        "name": "",
        "filename": "m3protag.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 710,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "910197e1.68a728",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "per24h",
        "func": "// per24h\n\nvar now = new Date() ;\n\n  function ISODateString(d){\n    function pad(n){return n<10 ? '0'+n : n}\n    return d.getFullYear()+'-'\n    + pad(d.getMonth()+1) +'-'\n    + pad(d.getDate())    +' '\n    + pad(d.getHours())   +':'\n    + pad(d.getMinutes()) +':'\n    + pad(d.getSeconds())\n}\n\n//  msg.payload = now.toLocaleString()  + \", \" +\n\n  msg.payload  =   ISODateString (now) + \", \" + \n  \n    Number.parseFloat\n    ((global.get('gGaszaehler')/10)).toFixed(1) + \", \" +\n     \n  ( (global.get ('gGaszaehler') - global.get('gGas_24'))/10) ;\n\n  \n  if ( global.get('gImpulse_per_m3') == 100 ){\n  msg.payload  =   ISODateString (now) + \", \" + \n    Number.parseFloat\n    ((global.get('gGaszaehler')/100)).toFixed(2) + \", \" +\n  ( (global.get ('gGaszaehler') - global.get('gGas_24'))/100) ;\n  \n  }\n  \n  global.set ('gGas_24', global.get ('gGaszaehler') ) ;\n  \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 540,
        "y": 360,
        "wires": [
            [
                "8dc5944f.68b5a8"
            ]
        ]
    },
    {
        "id": "7cd4ecc0.a4ed64",
        "type": "ui_chart",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "47cd2844.1a1288",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "48 h",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 650,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "c05e105b.55dd",
        "type": "ui_chart",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "47cd2844.1a1288",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "4 h",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "4",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 650,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "5328a7df.f0e1b8",
        "type": "ui_slider",
        "z": "559a98ba.60a488",
        "name": "",
        "label": "Simulation",
        "tooltip": "",
        "group": "ba8e00a6.e48ab",
        "order": 17,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "min": 0,
        "max": "3",
        "step": 1,
        "x": 430,
        "y": 1220,
        "wires": [
            [
                "b609116b.5e883"
            ]
        ]
    },
    {
        "id": "d834f896.abd878",
        "type": "inject",
        "z": "559a98ba.60a488",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "25",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "25",
        "payloadType": "num",
        "x": 130,
        "y": 1080,
        "wires": [
            [
                "84b77a1f.d20a58"
            ]
        ]
    },
    {
        "id": "84b77a1f.d20a58",
        "type": "switch",
        "z": "559a98ba.60a488",
        "name": "",
        "property": "gGenerator",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 290,
        "y": 1080,
        "wires": [
            [
                "1a7c6e38.e41a82"
            ]
        ]
    },
    {
        "id": "1a7c6e38.e41a82",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "   msg.payload = 1 ;\n   \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 1080,
        "wires": [
            [
                "94892c1d.8b06e"
            ]
        ]
    },
    {
        "id": "b9af424e.14c99",
        "type": "inject",
        "z": "559a98ba.60a488",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "9",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "9",
        "payloadType": "num",
        "x": 130,
        "y": 1120,
        "wires": [
            [
                "6d32cd9e.562d74"
            ]
        ]
    },
    {
        "id": "6d32cd9e.562d74",
        "type": "switch",
        "z": "559a98ba.60a488",
        "name": "",
        "property": "gGenerator",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "2",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 290,
        "y": 1120,
        "wires": [
            [
                "1a7c6e38.e41a82"
            ]
        ]
    },
    {
        "id": "5c199111.accf9",
        "type": "inject",
        "z": "559a98ba.60a488",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "5",
        "payloadType": "num",
        "x": 130,
        "y": 1160,
        "wires": [
            [
                "b0bff103.78aa2"
            ]
        ]
    },
    {
        "id": "b0bff103.78aa2",
        "type": "switch",
        "z": "559a98ba.60a488",
        "name": "",
        "property": "gGenerator",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "3",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 290,
        "y": 1160,
        "wires": [
            [
                "1a7c6e38.e41a82"
            ]
        ]
    },
    {
        "id": "a641b296.29084",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 14,
        "width": 3,
        "height": 1,
        "passthru": true,
        "label": "Blinken",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "num",
        "topic": "",
        "x": 140,
        "y": 860,
        "wires": [
            [
                "af081f74.3da74",
                "63889c0b.97dec4"
            ]
        ]
    },
    {
        "id": "af081f74.3da74",
        "type": "delay",
        "z": "559a98ba.60a488",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 400,
        "y": 900,
        "wires": [
            [
                "a0ddea15.af6388",
                "c9fd0381.9f58d"
            ]
        ]
    },
    {
        "id": "c9fd0381.9f58d",
        "type": "delay",
        "z": "559a98ba.60a488",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 400,
        "y": 960,
        "wires": [
            [
                "88501e96.81c1f",
                "63889c0b.97dec4"
            ]
        ]
    },
    {
        "id": "63889c0b.97dec4",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "1",
        "func": "  msg.payload = 1 ;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 650,
        "y": 860,
        "wires": [
            [
                "26889c62.5e6c94"
            ]
        ]
    },
    {
        "id": "a0ddea15.af6388",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "0",
        "func": "  msg.payload = 0 ;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 650,
        "y": 1020,
        "wires": [
            [
                "26889c62.5e6c94"
            ]
        ]
    },
    {
        "id": "88501e96.81c1f",
        "type": "delay",
        "z": "559a98ba.60a488",
        "name": "",
        "pauseType": "delay",
        "timeout": "300",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 400,
        "y": 1020,
        "wires": [
            [
                "a0ddea15.af6388"
            ]
        ]
    },
    {
        "id": "9e1af36d.900c2",
        "type": "inject",
        "z": "559a98ba.60a488",
        "name": "10 Sekunden",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "10",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 960,
        "wires": [
            [
                "c9fd0381.9f58d"
            ]
        ]
    },
    {
        "id": "26889c62.5e6c94",
        "type": "rpi-gpio out",
        "z": "559a98ba.60a488",
        "name": "",
        "pin": "13",
        "set": "",
        "level": "0",
        "freq": "",
        "out": "out",
        "x": 660,
        "y": 940,
        "wires": []
    },
    {
        "id": "d3ca1ad6.dc8918",
        "type": "comment",
        "z": "559a98ba.60a488",
        "name": "Gas_Meter 2021-04-02 - e@pofahl.de",
        "info": "Dieses Programm laeuft parallel zu einem Gaszaehler. Der Zaehlerstand wird per Reed-Kontakt erfasst.\n\nKeeps track of the gas meter reading by using a reed-contact.\n\n\nEkkehard@Pofahl.de",
        "x": 370,
        "y": 20,
        "wires": []
    },
    {
        "id": "9f09e4d4.f727f8",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "Watchdog",
        "func": "// Watchdog  2021-04-02\nvar now = new Date() ;\n\n  X_zeit = Date.now() - global.get ('gX_flanke') ;\n  global.set ('gX_zeit', X_zeit)  ;\n\n  Schwellenwert = 12 * 60 * 1000 ; // 12 Minuten\n  \n  global.set ('gSchwellenwert', Schwellenwert)   ;         \n  \n  if ( X_zeit > Schwellenwert) {global.set ('gLeistung', 0); }\n\n//  let options = { weekday: 'numeric', year: 'numeric', \n//    month: 'numeric', day: 'numeric' };\n\n// console.log(date.toLocaleString('de-DE', options));\n\n//   msg.payload =    now.toLocaleString () ;\n  \n//  Intl.DateTimeFormat(undefined, {\n//  year: 'numeric',\n//  month: 'numeric',\n//  day: 'numeric',\n//  hour: 'numeric',\n//  minute: 'numeric',\n//  second: 'numeric'\n//  }).format(d)\n \n \n// function pad(n){return n<10 ? '0'+n : n}\n\n\n/* use a function for the exact format desired... */\nfunction ISODateString(d){\n    function pad(n){return n<10 ? '0'+n : n}\n    return d.getFullYear()+'-'\n    + pad(d.getMonth()+1) +'-'\n    + pad(d.getDate())    +' '\n    + pad(d.getHours())   +':'\n    + pad(d.getMinutes()) +':'\n    + pad(d.getSeconds())\n}\n\n// var d = new Date();\n// console.log(ISODateString(d));\n\n  msg.payload = ISODateString (now) ;\n\n//  msg.payload =    now.toLocaleString () ;\n\n \n  \n  \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 760,
        "wires": [
            [
                "a8928a4f.732c48",
                "4d77818e.12d09"
            ]
        ]
    },
    {
        "id": "14ce04b1.06ebdb",
        "type": "ui_text_input",
        "z": "559a98ba.60a488",
        "name": "",
        "label": "",
        "tooltip": "",
        "group": "ba8e00a6.e48ab",
        "order": 11,
        "width": 3,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": "2000",
        "topic": "",
        "x": 310,
        "y": 180,
        "wires": [
            [
                "991d850e.388738"
            ]
        ]
    },
    {
        "id": "4d77818e.12d09",
        "type": "ui_text",
        "z": "559a98ba.60a488",
        "group": "ba8e00a6.e48ab",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Lokale Zeit",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 670,
        "y": 820,
        "wires": []
    },
    {
        "id": "9bc45d85.60248",
        "type": "ui_chart",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "47cd2844.1a1288",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "120 h",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "120",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 650,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "5f07f114.0984d",
        "type": "ui_chart",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ac933fde.66c148",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "iPad6h",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "6",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 660,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "58005a7d.94bb24",
        "type": "ui_chart",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "4686be15.d635d",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "iPhone1h",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "1",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 660,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "37487193.51c88e",
        "type": "file in",
        "z": "559a98ba.60a488",
        "name": "",
        "filename": "count.txt",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "utf8",
        "x": 700,
        "y": 100,
        "wires": [
            [
                "a2ccc897.8d1d88"
            ]
        ]
    },
    {
        "id": "1496df.b9009921",
        "type": "file",
        "z": "559a98ba.60a488",
        "name": "",
        "filename": "count.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "utf8",
        "x": 700,
        "y": 160,
        "wires": [
            [
                "305c0306.e903cc"
            ]
        ]
    },
    {
        "id": "6fb394b2.6f1d0c",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 15,
        "width": 3,
        "height": 1,
        "passthru": true,
        "label": "Laden",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "",
        "x": 390,
        "y": 100,
        "wires": [
            [
                "7046cc40.53ac64"
            ]
        ]
    },
    {
        "id": "7046cc40.53ac64",
        "type": "delay",
        "z": "559a98ba.60a488",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 540,
        "y": 100,
        "wires": [
            [
                "37487193.51c88e"
            ]
        ]
    },
    {
        "id": "991d850e.388738",
        "type": "delay",
        "z": "559a98ba.60a488",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 540,
        "y": 160,
        "wires": [
            [
                "1496df.b9009921"
            ]
        ]
    },
    {
        "id": "a2ccc897.8d1d88",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "Gewirxel",
        "func": "\n   puffer = msg.payload ;\n   msg.payload = Math.trunc (puffer) ;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 160,
        "y": 160,
        "wires": [
            [
                "991d850e.388738"
            ]
        ]
    },
    {
        "id": "66b278bb.5f9f48",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 12,
        "width": 3,
        "height": 1,
        "passthru": true,
        "label": "speichern",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 440,
        "y": 300,
        "wires": [
            [
                "8dd6ccb.427de3"
            ]
        ]
    },
    {
        "id": "c8a30219.f2fd2",
        "type": "ui_chart",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "4686be15.d635d",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "iPhone120h",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "120",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 670,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "24e9359.bd2eeca",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 4,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "+",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 130,
        "y": 260,
        "wires": [
            [
                "a9ca5d96.71ab6"
            ]
        ]
    },
    {
        "id": "60894555.68d97c",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "-",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 130,
        "y": 300,
        "wires": [
            [
                "d6756e3e.95af7"
            ]
        ]
    },
    {
        "id": "a9ca5d96.71ab6",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "  global.set ('gGaszaehler', (global.get('gGaszaehler') + 1)) ;\n  \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 260,
        "y": 260,
        "wires": [
            [
                "66b278bb.5f9f48"
            ]
        ]
    },
    {
        "id": "d6756e3e.95af7",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "   global.set (\"gGaszaehler\", (global.get(\"gGaszaehler\") - 1)) ;\n   \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 260,
        "y": 300,
        "wires": [
            [
                "66b278bb.5f9f48"
            ]
        ]
    },
    {
        "id": "bb8d9988.a99df8",
        "type": "ui_text",
        "z": "559a98ba.60a488",
        "group": "ba8e00a6.e48ab",
        "order": 3,
        "width": 3,
        "height": 1,
        "name": "",
        "label": "Gaszaehler",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 710,
        "y": 320,
        "wires": []
    },
    {
        "id": "8dd6ccb.427de3",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "     msg.payload = global.get(\"gGaszaehler\");\n     \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 220,
        "wires": [
            [
                "14ce04b1.06ebdb"
            ]
        ]
    },
    {
        "id": "305c0306.e903cc",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "Setze gGaszaehler",
        "func": "   global.set ('gGaszaehler', msg.payload ) ;\n   global.set ('gGas_24',     msg.payload ) ;\n   \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 670,
        "y": 220,
        "wires": [
            [
                "f74dd19f.a1f66"
            ]
        ]
    },
    {
        "id": "f74dd19f.a1f66",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "Lese gGaszaehler",
        "func": "\n   msg.payload = Number.parseFloat\n      ( (global.get('gGaszaehler') / 10) ).toFixed(1) ;\n\n   if (global.get ('gImpulse_per_m3') == 100 ) {\n     msg.payload = Number.parseFloat\n        ( (global.get('gGaszaehler') / 100) ).toFixed(2) ;\n   }\n\n  // msg.payload = global.get('gGaszaehler') / 10 ;\n   \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 670,
        "y": 280,
        "wires": [
            [
                "bb8d9988.a99df8"
            ]
        ]
    },
    {
        "id": "214b0dcd.942eb2",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "Tagesverbrauch",
        "func": "msg.payload = global.get('gGaszaehler') - global.get('gGas_24');\n   \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 360,
        "wires": [
            [
                "910197e1.68a728",
                "a9c4c2ab.04995"
            ]
        ]
    },
    {
        "id": "ddd89e17.de79f",
        "type": "ui_chart",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "3a86132b.eccf7c",
        "order": 1,
        "width": "0",
        "height": "0",
        "label": "Tagesverbrauch (m3)",
        "chartType": "bar",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 680,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "a9c4c2ab.04995",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "Tagesnr = new Date () ;\n\n   msg.topic = Tagesnr.getDate() ; \n\n   msg.payload = msg.payload / global.get ('gImpulse_per_m3') ;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 400,
        "wires": [
            [
                "ddd89e17.de79f"
            ]
        ]
    },
    {
        "id": "ae736c02.7e377",
        "type": "inject",
        "z": "559a98ba.60a488",
        "name": "5 Sekunden",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 760,
        "wires": [
            [
                "9f09e4d4.f727f8"
            ]
        ]
    },
    {
        "id": "47c880bf.a23c1",
        "type": "ui_button",
        "z": "559a98ba.60a488",
        "name": "",
        "group": "ba8e00a6.e48ab",
        "order": 9,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reset",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 110,
        "y": 1220,
        "wires": [
            [
                "b191662c.4e0a88"
            ]
        ]
    },
    {
        "id": "b191662c.4e0a88",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "    global.set ('gMin', 200000) ;\n    \n    msg.payload = 0 ;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 260,
        "y": 1220,
        "wires": [
            [
                "5328a7df.f0e1b8"
            ]
        ]
    },
    {
        "id": "9b9679ee.ef3478",
        "type": "ui_dropdown",
        "z": "559a98ba.60a488",
        "name": "",
        "label": "",
        "tooltip": "",
        "place": "Select option",
        "group": "cc710660.0f1078",
        "order": 0,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "10",
                "value": 10,
                "type": "num"
            },
            {
                "label": "100",
                "value": "100",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "",
        "x": 130,
        "y": 1280,
        "wires": [
            [
                "fe212768.8ac458"
            ]
        ]
    },
    {
        "id": "b609116b.5e883",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "  global.set ('gGenerator', msg.payload ) ;\n  \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 580,
        "y": 1220,
        "wires": [
            []
        ]
    },
    {
        "id": "fe212768.8ac458",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "  global.set ('gImpulse_per_m3', msg.payload );\n  \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1280,
        "wires": [
            [
                "bec70de7.34d17"
            ]
        ]
    },
    {
        "id": "bec70de7.34d17",
        "type": "file",
        "z": "559a98ba.60a488",
        "name": "",
        "filename": "impulse_per_m3.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 490,
        "y": 1280,
        "wires": [
            []
        ]
    },
    {
        "id": "10b52604.55466a",
        "type": "file in",
        "z": "559a98ba.60a488",
        "name": "",
        "filename": "impulse_per_m3.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 530,
        "y": 60,
        "wires": [
            [
                "9a01b29d.f17d2"
            ]
        ]
    },
    {
        "id": "9a01b29d.f17d2",
        "type": "function",
        "z": "559a98ba.60a488",
        "name": "",
        "func": "\n   global.set ('gImpulse_per_m3', msg.payload ) ;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 700,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "ba8e00a6.e48ab",
        "type": "ui_group",
        "name": "gHome",
        "tab": "171e8c97.da0913",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false
    },
    {
        "id": "47cd2844.1a1288",
        "type": "ui_group",
        "name": "Graf",
        "tab": "f061537.3e6acb",
        "order": 1,
        "disp": false,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ac933fde.66c148",
        "type": "ui_group",
        "name": "iPadGrp",
        "tab": "6419fa5c.b1f80c",
        "order": 1,
        "disp": false,
        "width": "13",
        "collapse": false
    },
    {
        "id": "4686be15.d635d",
        "type": "ui_group",
        "name": "iPhnGruppe",
        "tab": "391b3a9e.561c46",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false
    },
    {
        "id": "3a86132b.eccf7c",
        "type": "ui_group",
        "name": "EGruppe",
        "tab": "3ff7a896.491d28",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false
    },
    {
        "id": "cc710660.0f1078",
        "type": "ui_group",
        "name": "setup",
        "tab": "5dd640fc.c52c1",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "171e8c97.da0913",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f061537.3e6acb",
        "type": "ui_tab",
        "name": "Bilder",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "6419fa5c.b1f80c",
        "type": "ui_tab",
        "name": "iPad",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "391b3a9e.561c46",
        "type": "ui_tab",
        "name": "iPhone",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "3ff7a896.491d28",
        "type": "ui_tab",
        "name": "Energie",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "5dd640fc.c52c1",
        "type": "ui_tab",
        "name": "Einstellungen",
        "icon": "dashboard",
        "order": 6,
        "disabled": false,
        "hidden": false
    }
]
